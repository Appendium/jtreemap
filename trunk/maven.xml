<?xml version="1.0"?>

<!--
   /*  
   * ========================================================================
   * $Id: maven.xml 184 2006-09-17 09:42:49Z marchy $
   * 
   * Copyright 2006 the original author or authors.
   *
   * Licensed under the Apache License, Version 2.0 (the "License"); you may not
   * use this file except in compliance with the License. You may obtain a copy of
   * the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
   * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
   * License for the specific language governing permissions and limitations under
   * the License.
   * ========================================================================
   */
-->

<project xmlns:j="jelly:core" xmlns:ant="jelly:ant"
   xmlns:maven="jelly:maven" xmlns:x="jelly:xml">

   <goal name="jt:clean" prereqs="multiproject:clean,clean" />

   <goal name="jt:build">
      <j:set var="goal" value="jt:build" />
      <j:set var="do.obfuscation" value="false" scope="parent" />
      <attainGoal name="multiproject:goal" />
   </goal>

   <goal name="jt:rebuild">
      <attainGoal name="jt:clean" />
      <j:set var="goal" value="jt:rebuild" />
      <attainGoal name="multiproject:goal" />
   </goal>

   <goal name="jt:releasebuild">
      <attainGoal name="jt:rebuild" />
      <j:set var="goal" value="artifact:create-upload-bundle" />
      <attainGoal name="multiproject:goal" />
      <attainGoal name="jt:site" />
   </goal>

   <goal name="jt:site">
      <attainGoal name="dist:build" />
        <ant:copy file="${maven.build.dir}/docs/generic-appletsample.html" tofile="${maven.build.dir}/docs/appletsample.html" overwrite="true">
	    <ant:filterset>
	       <ant:filter token="JARVERSION" value="${pom.currentVersion}"/>
	    </ant:filterset>
        </ant:copy>
        <ant:copy file="${maven.build.dir}/docs/generic-jtreemap.jnlp" tofile="${maven.build.dir}/docs/jtreemap.jnlp" overwrite="true">
	    <ant:filterset>
	       <ant:filter token="JARVERSION" value="${pom.currentVersion}"/>
	    </ant:filterset>
        </ant:copy>
        <ant:copy file="${basedir}/jtreemap/target/jtreemap-${pom.currentVersion}.jar" tofile="${maven.build.dir}/docs/jtreemap-${pom.currentVersion}.jar" overwrite="true"/>
        <ant:delete file="${maven.build.dir}/docs/generic-appletsample.html"/>
        <ant:delete file="${maven.build.dir}/docs/generic-jtreemap.jnlp"/>

        <ant:copy todir="${maven.build.dir}/docs/samples" overwrite="true">
        	<fileset dir="./src/samples">
        		<include name="*.xml"/>
        		<include name="*.tm3"/>
        		<include name="*.dtd"/>
        	</fileset>
        </ant:copy>

        <attainGoal name="dist:multiproject" />      
        
        
   </goal>
</project>
